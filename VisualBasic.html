<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<meta name="description" content="Guia de Visual Basic .NET.">
<meta name="keywords" content="Visual, Basic, .NET, Visual Studio">
<meta name="author" content="Victor Herrero Cazurro">
<title>Visual Basic .NET</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css">
</head>
<body class="article toc2 toc-right">
<div id="header">
<h1>Visual Basic .NET</h1>
<div class="details">
<span id="author" class="author">Victor Herrero Cazurro</span><br>
<span id="email" class="email">&lt;<a href="https://github.com/victorherrerocazurro">@vherrero11</a>&gt;</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introducción">1. Introducción</a></li>
<li><a href="#_visual_studio">2. Visual Studio</a>
<ul class="sectlevel2">
<li><a href="#_vistas">2.1. Vistas</a></li>
<li><a href="#_solution_explorer">2.2. Solution Explorer</a></li>
<li><a href="#_properties">2.3. Properties</a></li>
<li><a href="#_toolbox">2.4. Toolbox</a></li>
<li><a href="#_espacio_de_edición">2.5. Espacio de Edición</a></li>
</ul>
</li>
<li><a href="#_sintaxis">3. Sintaxis</a>
<ul class="sectlevel2">
<li><a href="#_convenciones_de_nomenclatura">3.1. Convenciones de Nomenclatura</a></li>
<li><a href="#_comentarios">3.2. Comentarios</a></li>
<li><a href="#_subrayado">3.3. Subrayado</a></li>
<li><a href="#_separador_de_sentencias">3.4. Separador de sentencias</a></li>
</ul>
</li>
<li><a href="#_tipos_de_datos">4. Tipos de datos</a></li>
<li><a href="#_definición_de_variables">5. Definición de Variables</a></li>
<li><a href="#_operadores">6. Operadores</a>
<ul class="sectlevel2">
<li><a href="#_operadores_aritméticos">6.1. Operadores aritméticos</a></li>
<li><a href="#_operadores_lógicos">6.2. Operadores lógicos</a></li>
<li><a href="#_operadores_con_objetos">6.3. Operadores con objetos</a></li>
<li><a href="#_operadores_de_concatenación">6.4. Operadores de concatenación</a></li>
<li><a href="#_operadores_de_acceso">6.5. Operadores de acceso</a></li>
</ul>
</li>
<li><a href="#_arrays">7. Arrays</a></li>
<li><a href="#_sentencias_de_control_de_flujo">8. Sentencias de control de flujo</a>
<ul class="sectlevel2">
<li><a href="#_if_then_else">8.1. If&#8230;&#8203;Then&#8230;&#8203;Else</a></li>
<li><a href="#_select_case_case">8.2. Select Case&#8230;&#8203;Case</a></li>
<li><a href="#_while_end_while">8.3. While&#8230;&#8203;End While</a></li>
<li><a href="#_do_while_loop">8.4. Do While&#8230;&#8203;Loop</a></li>
<li><a href="#_do_loop_until">8.5. Do&#8230;&#8203;Loop Until</a></li>
<li><a href="#_for_to_step_next">8.6. For&#8230;&#8203;To&#8230;&#8203;Step&#8230;&#8203;Next</a></li>
<li><a href="#_for_each_in_next">8.7. For Each&#8230;&#8203;In&#8230;&#8203;Next</a></li>
<li><a href="#_using_end_using">8.8. Using&#8230;&#8203;End Using</a></li>
<li><a href="#_with_end_with">8.9. With&#8230;&#8203;End With</a></li>
</ul>
</li>
<li><a href="#_modificadores_de_acceso">9. Modificadores de Acceso</a>
<ul class="sectlevel2">
<li><a href="#_public">9.1. Public</a></li>
<li><a href="#_protected">9.2. Protected</a></li>
<li><a href="#_friend">9.3. Friend</a></li>
<li><a href="#_protected_friend">9.4. Protected Friend</a></li>
<li><a href="#_private">9.5. Private</a></li>
</ul>
</li>
<li><a href="#_orientacion_a_objetos">10. Orientacion a Objetos</a>
<ul class="sectlevel2">
<li><a href="#_encapsulación">10.1. Encapsulación</a></li>
<li><a href="#_herencia">10.2. Herencia</a></li>
<li><a href="#_polimorfismo">10.3. Polimorfismo</a></li>
</ul>
</li>
<li><a href="#_clases">11. Clases</a>
<ul class="sectlevel2">
<li><a href="#_miembros">11.1. Miembros</a></li>
<li><a href="#_campos_y_propiedades">11.2. Campos y Propiedades</a></li>
<li><a href="#_métodos">11.3. Métodos</a></li>
<li><a href="#_paso_de_parametros_a_métodos">11.4. Paso de parametros a métodos</a></li>
<li><a href="#_constructores">11.5. Constructores</a></li>
<li><a href="#_casting">11.6. Casting</a></li>
</ul>
</li>
<li><a href="#_estructuras">12. Estructuras</a></li>
<li><a href="#_modulos">13. Modulos</a></li>
<li><a href="#_namespace">14. Namespace</a></li>
<li><a href="#_palabras_reservadas">15. Palabras reservadas</a>
<ul class="sectlevel2">
<li><a href="#_me">15.1. Me</a></li>
<li><a href="#_mybase">15.2. MyBase</a></li>
<li><a href="#_new">15.3. New</a></li>
<li><a href="#_partial">15.4. Partial</a></li>
<li><a href="#_readonly">15.5. ReadOnly</a></li>
<li><a href="#_writeonly">15.6. WriteOnly</a></li>
<li><a href="#_shared">15.7. Shared</a></li>
<li><a href="#_static">15.8. Static</a></li>
<li><a href="#_nothing">15.9. Nothing</a></li>
<li><a href="#_optional">15.10. Optional</a></li>
</ul>
</li>
<li><a href="#_enumeraciones_y_constantes">16. Enumeraciones y constantes</a></li>
<li><a href="#_excepciones">17. Excepciones</a></li>
<li><a href="#_colecciones">18. Colecciones</a></li>
<li><a href="#_ado_net">19. ADO.NET</a>
<ul class="sectlevel2">
<li><a href="#_componentes_ado_net">19.1. Componentes ADO.NET</a></li>
<li><a href="#_connection">19.2. Connection</a></li>
<li><a href="#_command">19.3. Command</a></li>
<li><a href="#_datareader">19.4. DataReader</a></li>
<li><a href="#_dataadapter">19.5. DataAdapter</a></li>
<li><a href="#_dataset">19.6. DataSet</a></li>
<li><a href="#_connectionstring">19.7. ConnectionString</a></li>
</ul>
</li>
<li><a href="#_windows_forms">20. Windows Forms</a>
<ul class="sectlevel2">
<li><a href="#_datagridview">20.1. DataGridView</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introducción">1. Introducción</h2>
<div class="sectionbody">
<div class="paragraph">
<p>En Visual Basic se programa guiado por los eventos (event-driven programming),
esto es, que el flujo del programa, no viene definido por el
programador, como ocurre en la programación secuencial, sino por las acciones
que en cada momento realiza, sobre la aplicación el usuario de la misma.</p>
</div>
<div class="paragraph">
<p>El programador de la aplicación, define los eventos que manejará la aplicación
y las acciones que se realizarán al producirse dichos eventos, siendo las
acciones que realice el usuario, las que dispararán los eventos.</p>
</div>
<div class="paragraph">
<p>En una aplicación guiada por eventos, la aplicación inicializa los manejadores
al arrancarse, y se queda esperando, a la escucha de que se produzcan eventos,
cuando estos se producen, se ejecuta el codigo de los manejadores.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_visual_studio">2. Visual Studio</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Herramienta de Microsoft, que permite el desarrollo de aplicaciones tanto
de escritorio como Web, con distintos lenguajes.</p>
</div>
<div class="paragraph">
<p>Actualmente se proporciona una versión Comunity gratuita, que se puede descargar
desde <a href="https://www.visualstudio.com/es-es/downloads/download-visual-studio-vs.aspx"><strong>aqui</strong></a>.</p>
</div>
<div class="paragraph">
<p>En Visual Studio, la creación de proyectos se divide por lenguaje de .NET
Framework (Visual C#, Visual Basic, Visual F#, Visual C++, Pyhon, &#8230;&#8203;) y por
cada lenguaje, por las distintas tecnologias (Web, Windows, WCF, &#8230;&#8203;).</p>
</div>
<div class="sect2">
<h3 id="_vistas">2.1. Vistas</h3>
<div class="paragraph">
<p>Las principales vistas que ofrece Visual Studio son</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Solution Explorer</p>
</li>
<li>
<p>Properties</p>
</li>
<li>
<p>Toolbox</p>
</li>
<li>
<p>Espacio de Edición</p>
</li>
<li>
<p>Team Explorer</p>
</li>
<li>
<p>Data Sources</p>
</li>
<li>
<p>Output</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_solution_explorer">2.2. Solution Explorer</h3>
<div class="paragraph">
<p>Una de las ventanas principales de VS, es Solution Explorer, que permite navegar
por los ficheros que componen la Solución. Se ubica en la parte derecha de la
pantalla.</p>
</div>
<div class="imageblock thumb">
<div class="content">
<img src="images/Solution_Explorer_Window.png" alt="Solution Explorer Window">
</div>
</div>
<div class="paragraph">
<p>Una Solución será el espacio de trabajo, que puede estar compuestas por
distintos proyectos (compilados).</p>
</div>
</div>
<div class="sect2">
<h3 id="_properties">2.3. Properties</h3>
<div class="paragraph">
<p>Otra de las ventanas principales será la de Properties, que permite ver/editar
los metadatos de los distintos artefactos que componen la solución, como el
nombre de los ficheros. Tambien se ubica en la parte derecha de la pantalla.</p>
</div>
<div class="imageblock thumb">
<div class="content">
<img src="images/Properties_Window.png" alt="Properties Window">
</div>
</div>
<div class="paragraph">
<p>Las Propiedades de los formularios se pueden agrupar en categorias:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Accesibilidad (Accessibility),</p>
</li>
<li>
<p>Apariencia (Appearance),</p>
</li>
<li>
<p>Comportamiento (Behavior),</p>
</li>
<li>
<p>Datos (Data),</p>
</li>
<li>
<p>Diseño (Design),</p>
</li>
<li>
<p>Foco (Focus),</p>
</li>
<li>
<p>Layout,</p>
</li>
<li>
<p>Varios (Misc)</p>
</li>
<li>
<p>Estilos Windows (Window Style).</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_toolbox">2.4. Toolbox</h3>
<div class="paragraph">
<p>Otra de las ventanas principales, será Toolbox, donde apareceran los componentes
que se pueden arrastrar sobre el formulario. Se ubica en la parte izquierda de
la pantalla.</p>
</div>
<div class="imageblock thumb">
<div class="content">
<img src="images/Toolbox.png" alt="Toolbox">
</div>
</div>
<div class="paragraph">
<p>Dado que se pueden añadir varios controles a los formularios que hagan
referencia al mismo campo (label, textfield), para los nombres de los controles
se suelen emplear prefijos, se suelen emplear los que aparecen en la imagen.</p>
</div>
<div class="imageblock thumb">
<div class="content">
<img src="images/Control_Prefix.png" alt="Control Prefix">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_espacio_de_edición">2.5. Espacio de Edición</h3>
<div class="paragraph">
<p>Otra de las ventanas principales, será el par que forman el editor gráfico de
formularios y el editor de código. Ocupan la zona central de la pantalla.</p>
</div>
<div class="imageblock thumb">
<div class="content">
<img src="images/Editor_Grafico.png" alt="Editor Grafico">
</div>
</div>
<div class="imageblock thumb">
<div class="content">
<img src="images/Editor_Codigo.png" alt="Editor Codigo">
</div>
</div>
<div class="paragraph">
<p>Cuando se edita un fichero de formulario, por defecto se accede al editor
gráfico, para acceder al editor de código, se hará doble-click sobre el editor
gráfico. Opcionalmente se puede expandir, en la ventana de Solution Explorer,
el fichero que representa el formulario y editar el nodo que de este fichero
cuelga, que será el fichero de código.</p>
</div>
<div class="paragraph">
<p>El fichero de código, será una clase de VB, son la siguiente estructura</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Public Class HelloWorld
.
.
.
End Class</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sintaxis">3. Sintaxis</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Veamos algunas caracteristicas especificas de VB.NET en cuanto a la sintaxis.</p>
</div>
<div class="paragraph">
<p>Por ejemplo, las sentencias no llevan <strong>;</strong> al final.</p>
</div>
<div class="sect2">
<h3 id="_convenciones_de_nomenclatura">3.1. Convenciones de Nomenclatura</h3>
<div class="paragraph">
<p>Los nombres empezaran por un caracter alfanumerico o <strong>_</strong></p>
</div>
<div class="paragraph">
<p>En palabras compuestas, la primera letra de cada palabra, en mayusculas
(nomenclatura camel)</p>
</div>
<div class="paragraph">
<p>Los nombres de las interfaces, empiezan con <strong>I</strong></p>
</div>
<div class="paragraph">
<p>Los nombres de los métodos, empezarán con la primera letra en mayusculas.</p>
</div>
</div>
<div class="sect2">
<h3 id="_comentarios">3.2. Comentarios</h3>
<div class="paragraph">
<p>Los comentarios se insertan con el caracter <strong>'</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">'Esto es un comentario sobre el método
Private Sub BtSaludar_Click(sender As Object, e As EventArgs) Handles BtSaludar.Click

End Sub</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se puede incluir un comentario que permite incluir la documentación dentro de
la propia clase, con el triple apostrofe (<strong>'''</strong>), al introducirlo Visual Studio incluirá
lo siguiente</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">''' &lt;summary&gt;
'''
''' &lt;/summary&gt;
''' &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
''' &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
''' &lt;remarks&gt;&lt;/remarks&gt;
Private Sub BtSaludar_Click(sender As Object, e As EventArgs) Handles BtSaludar.Click

End Sub</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_subrayado">3.3. Subrayado</h3>
<div class="paragraph">
<p>El caracter de subrayado (<strong>_</strong>), permite partir una sentencia en varias lineas.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Private Sub BtSaludar_Click(sender As Object, e As EventArgs) Handles BtSaludar.Click

        Console.writeLine(&quot;Esta es la primera linea, &quot; _
                        + &quot;esta es la segunda, &quot; _
                        + &quot;y por ultimo la tercera&quot;)

End Sub</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_separador_de_sentencias">3.4. Separador de sentencias</h3>
<div class="paragraph">
<p>Para poder escribir varias instrucciones en una misma linea, se emplea el
separador <strong>:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">a = 3 : b = 4 : c = 5</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tipos_de_datos">4. Tipos de datos</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Tipo</th>
<th class="tableblock halign-left valign-top">Memoria</th>
<th class="tableblock halign-left valign-top">Valores</th>
<th class="tableblock halign-left valign-top">Observaciones</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Byte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 byte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 a 255</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entero sin signo</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SByte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 byte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-128 y 127</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entero con signo</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Short</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-32768 y 32767</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entero con signo</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UShort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 a 65535</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entero sin signo</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-2.147.483.648 a 2.147.483.647</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entero con signo</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UInteger</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 y 4.294.967.295</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entero sin signo</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8 bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">- 2147483648   a 2147483647 ó -9,2E+18 a 9,2E+18</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entero con signo</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ULong</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8 bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 a 18.446.744.073.709.551.615</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entero sin signo</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16 bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+/-79,228,162,514,264,337,593,543,950,335 y el valor más pequeño distinto de cero es +/-0.0000000000000000000000000001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enteros con signo de 12 bytes ajustados por una potencia variable de 10. El número de dígitos que hay a la derecha del separador decimal; va de 0 a 28.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">- 3,4·1038 a 3,4·1038</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Real</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8 bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">- 1,79·10308 a 1,79·10308</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Real</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">True o False</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Booleano</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Char</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 a 65535</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Caracter unicode</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 bytes + 1 byte por cada carácter</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alfanumérico</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 bytes</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tipo de dato referencia, contiene una direccion en memoria de un objeto</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variable</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fechas, se asigna como cadena con el formato "dd-MM-yy", se puede separar con - o con /. Ejemplo "01-02-16". Oto formato valido seria "dd-MMM-yyyy". Ejemplo "01-JAN-2016"</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_definición_de_variables">5. Definición de Variables</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Para la declaración de la variable y su tipo, se emplea las palabras reservadas
<strong>Dim</strong> y <strong>As</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim variable As Double</code></pre>
</div>
</div>
<div class="paragraph">
<p>Para la asginación de un valor a la variable, se emplea el operador <strong>=</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">variable = 3.2;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se pueden realizar la declaración y la asignación en una misma sentencia</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">' Si es un tipo basico
Dim real As Double = 3.2

' Si es un objeto
Dim cadena As New String(&quot;Esto es el string&quot;)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_operadores">6. Operadores</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_operadores_aritméticos">6.1. Operadores aritméticos</h3>
<div class="paragraph">
<p>Permiten realizar calculos con valores numéricos.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Operador</th>
<th class="tableblock halign-left valign-top">Simbolo</th>
<th class="tableblock halign-left valign-top">Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">asignación</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Permite asignar a una variable el resultado de una sentencia</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">suma</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Permite realizar una suma con dos valores numéricos</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resta</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Permite realizar una resta con dos valores numéricos</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">negativo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Permite indicar que un número es negativo</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">multiplicación</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Permite multplicar dos valores numéricos</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">división</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Permite dividir dos valores numéricos obteniendo un número real</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">exponenciación</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">^</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Permite elevar un numeró a otro número</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">división entera</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Permite obtener el cociente de la división, prescindiendo del resto</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_división_por_cero">6.1.1. División por cero</h4>
<div class="paragraph">
<p>La división por cero produce resultados diferentes dependiendo de los tipos de datos que se utilicen.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>En divisiones de enteros (SByte, Byte, Short, UShort, Integer, UInteger, Long, ULong), se lanza una excepción DivideByZeroException.</p>
</li>
<li>
<p>En operaciones de división del tipo de datos Decimal o Single, se lanza una excepción DivideByZeroException.</p>
</li>
<li>
<p>En las divisiones con el tipo Double, no se produce ninguna excepción, el resultado es</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Tipo de datos del dividendo</th>
<th class="tableblock halign-left valign-top">Tipo de datos del divisor</th>
<th class="tableblock halign-left valign-top">Valor del dividendo</th>
<th class="tableblock halign-left valign-top">Resultado</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NaN (no es un número definido matemáticamente)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt; 0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PositiveInfinity</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt; 0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NegativeInfinity</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_operadores_lógicos">6.2. Operadores lógicos</h3>
<div class="paragraph">
<p>Permiten compara dos expresiones, retornando un valor Booleano.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Operador</th>
<th class="tableblock halign-left valign-top">Simbolo</th>
<th class="tableblock halign-left valign-top">Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">igualdad</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compara si dos expresiones son iguales</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">desigualdad</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt; &gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compara si dos expresiones son distintas</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">menor que</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compara si la primera expresion es menor que la segunda</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mayor que</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compara si la primera expresion es mayor que la segunda</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">menor o igual que</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt; =</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compara si la primera expresion es menor o igual que la segunda</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mayor o igual que</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt; =</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compara si la primera expresion es mayor o igual que la segunda</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_comparación_de_cadenas_de_caracteres">6.2.1. Comparación de cadenas de caracteres</h4>
<div class="paragraph">
<p>Se pueden compara cadenas de caracteres (String), teniendo el siguiente comportamiento</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Se compara caracter a caracter</p>
</li>
<li>
<p>En caso de igualdad, se recurre al siguiente caracter</p>
</li>
<li>
<p>En el caso de que una sea subcadena de la otra, la mas larga es la mayor</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_operador_like">6.2.2. Operador Like</h4>
<div class="paragraph">
<p>Permite comparar un cadena con un patrón.</p>
</div>
<div class="paragraph">
<p>Para definir el patrón se pueden emplear los siguientes caracteres especiales</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Caracteres de pattern</th>
<th class="tableblock halign-left valign-top">Coincidencias en string</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cualquier carácter individual</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cero o más caracteres</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">#</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cualquier dígito individual (0-9)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ charlist ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cualquier carácter individual de charlist</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">[! charlist ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cualquier carácter individual que no esté incluido en charlist</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim resultado As Boolean
' La siguiente sentencia retorna True
resultado = &quot;F&quot; Like &quot;F&quot;

' La siguiente sentencia retorna False, ya que una efe mayuscula (F),
' no es igual a una efe minuscula (f)
resultado = &quot;F&quot; Like &quot;f&quot;

' La siguientes sentencia retorna False, ya que una efe (F),
' no es igual a 3 efes (FFF)
resultado = &quot;F&quot; Like &quot;FFF&quot;

' La siguiente sentencia retorna True, ya que la expresión 'a*a' indica que
' el String deberá empezar y terminar por 'a' y entre medias puede haber un número
' indeterminado de caracteres
resultado = &quot;aBBBa&quot; Like &quot;a*a&quot;

' La siguiente sentencia retorna True, ya que F esta en e intervalo que va desde
' A hasta Z
resultado = &quot;F&quot; Like &quot;[A-Z]&quot;
' La siguiente sentencia retorna False, ya que R no esta en e intervalo que va desde
' A hasta M
resultado = &quot;R&quot; Like &quot;[A-M]&quot;
' La siguiente sentencia retorna False, ya que F esta en e intervalo que va desde
' A hasta Z, y se está negando el intervalo
resultado = &quot;F&quot; Like &quot;[!A-Z]&quot;
' La siguiente sentencia retorna True, ya que a no esta en el intervalo que va desde
' A hasta Z, y se está negando el intervalo
resultado = &quot;a&quot; Like &quot;[!A-Z]&quot;
' La siguiente sentencia retorna True, ya que empieza y termina con a, y en el medio
' tiene un unico digito numérico
resultado = &quot;a2a&quot; Like &quot;a#a&quot;
' La siguiente sentencia retorna True, ya que &quot;aM5b&quot; empieza por a seguido de un
' caracter entre L y P, seguido de un digito numerico y acaba con un caracter
' fuera del rango entre c y e
resultado = &quot;aM5b&quot; Like &quot;a[L-P]#[!c-e]&quot;
' La siguiente sentencia retorna True, ya que &quot;BAT123khg&quot; empieza por &quot;B&quot;, seguido
' seguido por un caracter unico, en este caso A, despues T y finalmente un numero
' indeterminado de caracteres
resultado = &quot;BAT123khg&quot; Like &quot;B?T*&quot;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_operadores_con_objetos">6.3. Operadores con objetos</h3>
<div class="paragraph">
<p>Exiten en VisualBasic.Net dos operadores que permiten comparar si dos variables
hacen referencia exactamente a la misma instancia en memoria de un objeto</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Is</strong></p>
</li>
<li>
<p><strong>IsNot</strong></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">' Operador Is

Dim x As Persona
        Dim y As New Persona()
  x = y
  If x Is y Then
          Console.WriteLine(&quot;Las variables hacen referencia a la misma instancia&quot;)
End If

' Operador IsNot

x = New Persona()
If x IsNot y Then
        Console.WriteLine(&quot;Ahora las variables no hacen referencia a la misma instancia&quot;)
End If</code></pre>
</div>
</div>
<div class="paragraph">
<p>Tambien es posible, conocer el tipo del objeto al que apunta una variable, con el
operador <strong>TypeOf</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">' Operador TypeOf

Dim y As New Persona()
If TypeOf y Is Persona Then
                Console.WriteLine(&quot;La variable x hace referencia a un objeto de tipo Persona&quot;)
End If</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_operadores_de_concatenación">6.4. Operadores de concatenación</h3>
<div class="paragraph">
<p>En VB se pueden emplear los operadores <strong>&amp;</strong> y <strong>+</strong> para concatenar cadenas de caracteres,
siendo su comportamiento el siguiente</p>
</div>
<div class="paragraph">
<p><strong>&amp;</strong> concatena</p>
</div>
<div class="paragraph">
<p><strong>+</strong> concatena cuando se trabaja con afanumericos y suma cuando son numericos,
ojo que si el numerico se representa como una cadena, tambien suma.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">var1 = &quot;10.01&quot;
var2 = 11
resultado1 = var1 &amp; var2 //10.0111
resultado2 = var1 + var2 //21.01</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_operadores_de_acceso">6.5. Operadores de acceso</h3>
<div class="paragraph">
<p>Se pueden emplear <strong>.</strong> y <strong>!</strong></p>
</div>
<div class="paragraph">
<p><strong>.</strong> permite acceder a miembros (campos, propiedades, eventos o metodos) de Clases, Estructuras, Interfaces o Enumeraciones.</p>
</div>
<div class="paragraph">
<p><strong>!</strong> permite acceder al diccionario de Clases o Interfaces. Se conoce como diccionario a una Propiedad predeterminada que acepta un solo argumento String</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Public Class MiClase

        Default Public ReadOnly Property index(ByVal s As String) As String

                Get
                        return s
                End Get

        End Property

End Class

Public Class TestMiClase

        Public Sub AccesoDiccionario()

                Dim variable As MiClase = New MiClase()

                variable!X //Retornará el String &quot;X&quot;

        End Sub

End Class</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_arrays">7. Arrays</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Un array es un conjunto ordenado de objetos del mismo tipo.</p>
</div>
<div class="paragraph">
<p>Es necesario definir el tamaño del <strong>Array</strong> al construir el objeto, ya sea de forma explicita, indicando el numero de elementos del <strong>Array</strong> o de forma implicita, indicando los elementos del <strong>Array</strong>.</p>
</div>
<div class="paragraph">
<p>A la hora de declarar una variable, se ha de afectar o bien al nombre de la varaible o bien al tipo de los elementos del <strong>Array</strong>, con <strong>()</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">' Declaracion implicita
Dim numbers = New Integer() {1, 2, 4, 8}
Dim doubles() As Double = {1.5, 2, 9.9, 18}
Dim singles As Single() = {1.5, 2, 9.9, 18}

'Declaracion explicita
Dim numbers = New Integer(4) {}
Dim doubles() As Double = New Double(4) {}
Dim singles() As Single = New Single(4) {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>De indicar los elementos, no se indica el tamaño, es el tamaño - 1, es decir el índice del último elemento, ya que el primer indice es 0.</p>
</div>
<div class="paragraph">
<p>El tamaño es fijo, pero se puede redimensionar con la palabra reservada <strong>ReDim</strong>, si se emplea adicionalmente <strong>Preserve</strong>, se preservaran los elementos que estuvieran definidos. En realidad un <strong>Array</strong> no se redimensiona, sino que se crea un objeto nuevo de tipo Array y se pueden o no copiar los datos de uno a otro.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">ReDim Preserve numbers(20)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Para añadir elementos al <strong>Array</strong>, se emplea la variable de tipo Array, indicando entre parentesis la posición donde se quiere añadir el elemento y a esa expresion se le asigna el valor, para leerlos de forma analoga.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">numbers(1) = 0</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se pueden definir arrays multidimensionales</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim matrix = {{1, 2}, {3, 4}}

Dim matrix()() As Integer = {{1, 2}, {3, 4}}

Dim matrix = New Integer(3, 1) {{1, 2}, {3, 4}, {5, 6}, {7, 8}}

Dim matrix()() As Integer = New Integer(11)() {}

Dim matrix As Integer(,) = {{1, 2}, {3, 4}, {5, 6}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Un <strong>Array</strong> es iterable, dado que permite conocer el indice mayor de cada dimension del <strong>Array</strong>, con el método <strong>GetUpperBound</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">' Se itera desde 0 hasta el indice mayor de la dimension primera del array numbers
For index = 0 To numbers.GetUpperBound(0)
        Debug.WriteLine(numbers(index))
Next</code></pre>
</div>
</div>
<div class="paragraph">
<p>De forma analoga se pueden iterar <strong>Arrays</strong> multidimensionales</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">For index0 = 0 To matrix.GetUpperBound(0)
    For index1 = 0 To matrix.GetUpperBound(1)
        Debug.Write(matrix(index0, index1).ToString &amp; &quot; &quot;)
    Next
    Debug.WriteLine(&quot;&quot;)
Next</code></pre>
</div>
</div>
<div class="paragraph">
<p>Tambien se puede iterar con la sentencia For&#8230;&#8203;Each..Next, aunque esta da menos control sobre los elementos y su posición</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">For Each number In numbers
    Debug.WriteLine(number)
Next

' Iteracion sobre array multidimensional, no hay control sobre si se recorre por filas o columnas, es siempre por filas,
' y tampoco se controla cuando acaba una fila
For Each number In matrix
    Debug.WriteLine(number)
Next</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sentencias_de_control_de_flujo">8. Sentencias de control de flujo</h2>
<div class="sectionbody">
<div class="paragraph">
<p>VB.NET se ejecuta de forma secuencial, sentencia a sentencia, cuando hay una
invocación de un método, se ejecuta secuencialmente el contenido del método.</p>
</div>
<div class="paragraph">
<p>Existen una serie de sentencias que permiten modificar este comportamiento.</p>
</div>
<div class="sect2">
<h3 id="_if_then_else">8.1. If&#8230;&#8203;Then&#8230;&#8203;Else</h3>
<div class="paragraph">
<p>Estructura de control, que permite tomar una decisión de ejecutar un conjunto de
sentencias, si se cumple una condición.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim count As Integer = 0
Dim message As String

If count = 0 Then
    message = &quot;There are no items.&quot;
ElseIf count = 1 Then
    message = &quot;There is 1 item.&quot;
Else
    message = &quot;There are &quot; &amp; count &amp; &quot; items.&quot;
End If</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_select_case_case">8.2. Select Case&#8230;&#8203;Case</h3>
<div class="paragraph">
<p>Estructura de control, que permite evaluar una expresión, y dependiendo de su
valor, ejecutar un conjunto de sentencias u otro.</p>
</div>
<div class="paragraph">
<p>El valor de la expresión, debera ser de tipo básico (Boolean, Byte, Char, Date,
Double, Decimal, Integer, Long, Object, SByte, Short, Single, String, UInteger,
ULong y UShort)</p>
</div>
<div class="paragraph">
<p>Las sentencias de Case son excluyentes, si se cumple una, no se sigue
comprobando el resto.</p>
</div>
<div class="paragraph">
<p>Se pueden emplear las palabras reservadas <strong>Is</strong> y <strong>To</strong> en los Case, para
establecer</p>
</div>
<div class="paragraph">
<p><strong>Is</strong> &#8594; Expresiones booleanas ciertas</p>
</div>
<div class="paragraph">
<p><strong>To</strong> &#8594; Rangos de valores</p>
</div>
<div class="paragraph">
<p>===</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim number As Integer = 8
Select Case number
    Case 1 To 5
        Debug.WriteLine(&quot;Entre 1 y 5, incluidos&quot;)
    ' La siguiente clausula es la unica que se cumple.
    Case 6, 7, 8
        Debug.WriteLine(&quot;Entre 6 y 8, incluidos&quot;)
    Case 9 To 10
        Debug.WriteLine(&quot;9 o 10&quot;)
                Case Is &gt; 10
                        Debug.WriteLine(&quot;mayor que 10&quot;)
    Case Else
        Debug.WriteLine(&quot;Ninguna de las anteriores&quot;)
End Select</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_while_end_while">8.3. While&#8230;&#8203;End While</h3>
<div class="paragraph">
<p>Estructura que permite ejecutar una serie de sentencias de forma repetida, siempre
que se cumpla una expresión Booleana</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim index As Integer = 0
While index &lt;= 10
    Debug.Write(index.ToString &amp; &quot; &quot;)
    index += 1
End While

Debug.WriteLine(&quot;&quot;)
' Output: 0 1 2 3 4 5 6 7 8 9 10</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se puede finalizar la iteración en cualquier momento ejecutando <strong>Exit While</strong></p>
</div>
<div class="paragraph">
<p>O tambien se puede finalizar una iteración, dejando de ejecutar el resto de
sentencias dentro del bloque <strong>While</strong>, pasando inmediatamente a la siguiente
ieración, si la hubiera, con <strong>Continue While</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim index As Integer = 0
While index &lt; 100000
    index += 1

    ' If index is between 5 and 7, continue
    ' with the next iteration.
    If index &gt;= 5 And index &lt;= 8 Then
        Continue While
    End If

    ' Display the index.
    Debug.Write(index.ToString &amp; &quot; &quot;)

    ' If index is 10, exit the loop.
    If index = 10 Then
        Exit While
    End If
End While

Debug.WriteLine(&quot;&quot;)
' Output: 1 2 3 4 9 10</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_do_while_loop">8.4. Do While&#8230;&#8203;Loop</h3>
<div class="paragraph">
<p>Repite un bloque de instrucciones mientras una condición Boolean sea True, si se
emplea <strong>While</strong> o hasta que la condición se convierta en True si se emplea <strong>Until</strong>.</p>
</div>
<div class="paragraph">
<p>La condición se comprueba al principio, asociado a <strong>Do</strong>, con lo que puede ser que el bloque no se ejecute nunca</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim index As Integer = 0
Do While index &lt;= 10
    Debug.Write(index.ToString &amp; &quot; &quot;)
    index += 1
Loop

Debug.WriteLine(&quot;&quot;)
' Output: 0 1 2 3 4 5 6 7 8 9 10</code></pre>
</div>
</div>
<div class="paragraph">
<p>De forma analoga a como sucede con la sentencia <strong>While</strong>, se puede finalizar las
iteraciones con <strong>Exit Do</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim index As Integer = 0
Do While index &lt;= 100
    If index &gt; 10 Then
        Exit Do
    End If

    Debug.Write(index.ToString &amp; &quot; &quot;)
    index += 1
Loop

Debug.WriteLine(&quot;&quot;)
' Output: 0 1 2 3 4 5 6 7 8 9 10</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_do_loop_until">8.5. Do&#8230;&#8203;Loop Until</h3>
<div class="paragraph">
<p>La condición se compruebe al final del bloque, asociado a <strong>Loop</strong>,
con lo que el bloque al menos se ejecuta una vez.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim index As Integer = 0
Do
    Debug.Write(index.ToString &amp; &quot; &quot;)
    index += 1
Loop Until index &gt; 10

Debug.WriteLine(&quot;&quot;)
' Output: 0 1 2 3 4 5 6 7 8 9 10</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_for_to_step_next">8.6. For&#8230;&#8203;To&#8230;&#8203;Step&#8230;&#8203;Next</h3>
<div class="paragraph">
<p>Sentencia que permite repetir un grupo de sentencias un número de veces especificado.</p>
</div>
<div class="paragraph">
<p>Se establece una variable de control <strong>Counter</strong> que variará en un rango definido por <strong>To</strong> con una
variación por iteración de 1 por defecto, puediendose definir con <strong>Step</strong></p>
</div>
<div class="paragraph">
<p>Los posibles tipos de <strong>Counter</strong> son un Byte, SByte, UShort, Short, UInteger, Integer, ULong,
Long, Decimal, Single, o Double.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">For number As Double = 2 To 0 Step -0.25
    Debug.Write(number.ToString &amp; &quot; &quot;)
Next
Debug.WriteLine(&quot;&quot;)
' Output: 2 1.75 1.5 1.25 1 0.75 0.5 0.25 0</code></pre>
</div>
</div>
<div class="paragraph">
<p>O una enumeración.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Public Enum Mammals
    Buffalo
    Gazelle
    Mongoose
    Rhinoceros
    Whale
End Enum

Public Sub ListSomeMammals()
    For mammal As Mammals = Mammals.Gazelle To Mammals.Rhinoceros
        Debug.Write(mammal.ToString &amp; &quot; &quot;)
    Next
    Debug.WriteLine(&quot;&quot;)
    ' Output: Gazelle Mongoose Rhinoceros
End Sub</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se pueden anidar sentencias <strong>For&#8230;&#8203;Next</strong>, teniendo en cuenta que variable contador
ha de controlar la repetición de cada bucle.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">For indexA = 1 To 3
    ' Create a new StringBuilder, which is used
    ' to efficiently build strings.
    Dim sb As New System.Text.StringBuilder()

    ' Append to the StringBuilder every third number
    ' from 20 to 1 descending.
    For indexB = 20 To 1 Step -3
        sb.Append(indexB.ToString)
        sb.Append(&quot; &quot;)
    Next indexB

    ' Display the line.
    Debug.WriteLine(sb.ToString)
Next indexA
' Output:
'  20 17 14 11 8 5 2
'  20 17 14 11 8 5 2
'  20 17 14 11 8 5 2</code></pre>
</div>
</div>
<div class="paragraph">
<p>De forma analoga a como sucede con la sentencia <strong>While</strong>, se puede finalizar la
iteración en cualquier momento ejecutando <strong>Exit For</strong></p>
</div>
<div class="paragraph">
<p>O tambien se puede finalizar una iteración, dejando de ejecutar el resto de
sentencias dentro del bloque <strong>For</strong>, pasando inmediatamente a la siguiente
iteración, si la hubiera, con <strong>Continue For</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">For index As Integer = 1 To 100000
    ' If index is between 5 and 7, continue
    ' with the next iteration.
    If index &gt;= 5 And index &lt;= 8 Then
        Continue For
    End If

    ' Display the index.
    Debug.Write(index.ToString &amp; &quot; &quot;)

    ' If index is 10, exit the loop.
    If index = 10 Then
        Exit For
    End If
Next
Debug.WriteLine(&quot;&quot;)
' Output: 1 2 3 4 9 10</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_for_each_in_next">8.7. For Each&#8230;&#8203;In&#8230;&#8203;Next</h3>
<div class="paragraph">
<p>Repite un grupo de instrucciones para cada elemento de una colección.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">' Create a list of strings by using a
' collection initializer.
Dim lst As New List(Of String) _
    From {&quot;abc&quot;, &quot;def&quot;, &quot;ghi&quot;}

' Iterate through the list.
For Each item As String In lst
    Debug.Write(item &amp; &quot; &quot;)
Next
Debug.WriteLine(&quot;&quot;)
'Output: abc def ghi</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se pueden anidar.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">' Create lists of numbers and letters
' by using array initializers.
Dim numbers() As Integer = {1, 4, 7}
Dim letters() As String = {&quot;a&quot;, &quot;b&quot;, &quot;c&quot;}

' Iterate through the list by using nested loops.
For Each number As Integer In numbers
    For Each letter As String In letters
        Debug.Write(number.ToString &amp; letter &amp; &quot; &quot;)
    Next
Next
Debug.WriteLine(&quot;&quot;)
'Output: 1a 1b 1c 4a 4b 4c 7a 7b 7c</code></pre>
</div>
</div>
<div class="paragraph">
<p>De forma analoga a como sucede con la sentencia <strong>For</strong>, se puede finalizar la
iteración en cualquier momento ejecutando <strong>Exit For</strong></p>
</div>
<div class="paragraph">
<p>O tambien se puede finalizar una iteración, dejando de ejecutar el resto de
sentencias dentro del bloque <strong>For</strong>, pasando inmediatamente a la siguiente
iteración, si la hubiera, con <strong>Continue For</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="_using_end_using">8.8. Using&#8230;&#8203;End Using</h3>
<div class="paragraph">
<p>Sentencia que permite declarar uno o varios recursos que serán gestionados por el entorno,
por lo que se cerrarán de forma automatica.</p>
</div>
<div class="paragraph">
<p>Los recursos gestionados deben implementar la interface <strong>IDisposable</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Private Sub WriteFile()
    Using writer As System.IO.TextWriter = System.IO.File.CreateText(&quot;log.txt&quot;)
        writer.WriteLine(&quot;This is line one.&quot;)
        writer.WriteLine(&quot;This is line two.&quot;)
    End Using
End Sub

Private Sub ReadFile()
    Using reader As System.IO.TextReader = System.IO.File.OpenText(&quot;log.txt&quot;)
        Dim line As String

        line = reader.ReadLine()
        Do Until line Is Nothing
            Console.WriteLine(line)
            line = reader.ReadLine()
        Loop
    End Using
End Sub</code></pre>
</div>
</div>
<div class="paragraph">
<p>Esta sentenia permite ahorrar la escritura de una buena parte de codigo dado que los
siguientes bloques son equivalentes</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">' Bloque que permite el uso del recurso resource y su cerrado automatico
Using resource As New resourceType
    ' Insert code to work with resource.
End Using

' Bloque que permite el uso del recurso resource, pero el cerrado (Dispose()), se hace
' manualmente
Dim resource As New resourceType
Try
    ' Insert code to work with resource.
Finally
    If resource IsNot Nothing Then
        resource.Dispose()
    End If
End Try</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_with_end_with">8.9. With&#8230;&#8203;End With</h3>
<div class="paragraph">
<p>Sentencia que permite referenciar  a un objeto y dentro del bloque acceder de forma sucesiva
a las caracteristicas de dicho objeto, sin necesidad de volver a establecer la referencia.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Private Sub AddCustomer()
    Dim theCustomer As New Customer

    With theCustomer
        .Name = &quot;Coho Vineyard&quot;
        .URL = &quot;http://www.cohovineyard.com/&quot;
        .City = &quot;Redmond&quot;
    End With

    With theCustomer.Comments
        .Add(&quot;First comment.&quot;)
        .Add(&quot;Second comment.&quot;)
    End With
End Sub

Public Class Customer
    Public Property Name As String
    Public Property City As String
    Public Property URL As String

    Public Property Comments As New List(Of String)
End Class</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se pueden anidar estos bloques</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim theWindow As New EntryWindow

With theWindow
    With .InfoLabel
        .Content = &quot;This is a message.&quot;
        .Foreground = Brushes.DarkSeaGreen
        .Background = Brushes.LightYellow
    End With

    .Title = &quot;The Form Title&quot;
    .Show()
End With</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_modificadores_de_acceso">9. Modificadores de Acceso</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Los modificadores e acceso permiten defini que codigo tiene acceso a un determinado elemento.</p>
</div>
<div class="sect2">
<h3 id="_public">9.1. Public</h3>
<div class="paragraph">
<p>Especifica que se puede acceder desde cualquier contexto al elemento declarado.</p>
</div>
<div class="paragraph">
<p>Se puede emplear sobre: Interface, Module, Class, Structure, Dim, Sub, Function, Property, Const, Enum, Event y Delegate</p>
</div>
</div>
<div class="sect2">
<h3 id="_protected">9.2. Protected</h3>
<div class="paragraph">
<p>Especifica que se puede acceder al elemento declarado desde el contexto de declaración o desde una clase derivada del contexto de declaración.</p>
</div>
<div class="paragraph">
<p>Se puede emplear sobre: Interface, Class, Structure, Dim, Sub, Function, Property, Const, Enum, Event y Delegate.</p>
</div>
</div>
<div class="sect2">
<h3 id="_friend">9.3. Friend</h3>
<div class="paragraph">
<p>Especifica que se puede acceder al elemento solo desde el mismo ensamblado donde esta declarado el elemento, y no desde otros ensamblados.</p>
</div>
<div class="paragraph">
<p>Se puede emplear sobre: Interface, Module, Class, Structure, Dim, Sub, Function, Property, Const, Enum, Event y Delegate.</p>
</div>
</div>
<div class="sect2">
<h3 id="_protected_friend">9.4. Protected Friend</h3>
<div class="paragraph">
<p>Especifica que se puede acceder al elemento declarado, desde el mismo ensamblado, desde clases derivadas del contexto donde se declara o ambas.</p>
</div>
<div class="paragraph">
<p>Se puede emplear sobre: Interface, Class, Structure, Dim, Sub, Function, Property, Const, Enum, Event y Delegate.</p>
</div>
</div>
<div class="sect2">
<h3 id="_private">9.5. Private</h3>
<div class="paragraph">
<p>Especifica que sólo se puede tener acceso al elemento declarado desde el contexto de la declaración.</p>
</div>
<div class="paragraph">
<p>Se puede emplear sobre: Interface, Class, Structure, Dim, Sub, Function, Property, Const, Enum, Event y Delegate.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_orientacion_a_objetos">10. Orientacion a Objetos</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Paradigma de programación que emplea <strong>Objetos</strong> para la creación de aplicaciones.</p>
</div>
<div class="paragraph">
<p>Se persigue que los <strong>Objetos</strong> representen elementos concretos, que realicen tareas especificas, consiguiendo que cada elemento aporte al conjunto algo único y útil para la funcionalidad de la aplicación.</p>
</div>
<div class="paragraph">
<p>Uno de los objetivos de la Orientación a Objetos es la de no repetir código, lo cual permite identificar facilmente problemas en los algoritmos, lo cual repercute en la buena mantenibilidad.</p>
</div>
<div class="paragraph">
<p>Se basa principalmente en tres tecnicas</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Encapsulación</p>
</li>
<li>
<p>Herencia</p>
<div class="ulist">
<ul>
<li>
<p>Abstracción</p>
</li>
<li>
<p>Interfaces</p>
</li>
</ul>
</div>
</li>
<li>
<p>Polimorfismo</p>
<div class="ulist">
<ul>
<li>
<p>Sobrecarga</p>
</li>
<li>
<p>Sobrescritura</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_encapsulación">10.1. Encapsulación</h3>
<div class="paragraph">
<p>Busca que los objetos sean responsables de sus caracteristicas, de tal forma que otros objetos que interaccionen con el, no puedan acceder o modificar sus caracteristicas, para ello se precisan modificadores de acceso para las caracteristicas.</p>
</div>
<div class="paragraph">
<p>Tipicamente, se definen métodos que permiten interaccionar con dichas caracteristicas, estos métodos por convenio se llaman <strong>Get</strong> para leer el valor de la caracteristica y <strong>Set</strong> para establecer el valor de la caracteristica.</p>
</div>
<div class="paragraph">
<p>En VB.NET la encapsulación se consigue con las <strong>propiedades</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Public Class employee
        ' Declaración de propiedad sobre un campo privado con get y set
        Public Property salary() As Double
        Get
            Return salaryValue
        End Get
        Set(ByVal value As Double)
            salaryValue = value
        End Set
    End Property
End Class</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_herencia">10.2. Herencia</h3>
<div class="paragraph">
<p>Permite la reutilización de código, para aquellos elementos que compartan parte de su definición.</p>
</div>
<div class="paragraph">
<p>La idea de la herencia es poder agrupar en una clase padre todas las caracteristicas comunes de varios tipos de objetos, clases hijas, de tal forma que se escriban una unica vez, aunque esten presentes en todas esas tipologias hijas.</p>
</div>
<div class="paragraph">
<p>La herencia en VB.NEt es simple, no se permite heredar de varias clases a la vez.</p>
</div>
<div class="paragraph">
<p>El modificador de acceso de una clase hija debe ser igual o más restrictivo que el de su clase padre. Por ejemplo, una clase Public no puede heredar una clase Friend o Private, y una clase Friend no puede heredar una clase Private.</p>
</div>
<div class="paragraph">
<p>En VB.NET la herencia se establece con la palabra reservada <strong>Inherits</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Class Persona

End Class

Class Trabajador
    Inherits Persona

End Class</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se puede heredar de todas las clases, excepto que hayan sido marcadas con la palabra reservada <strong>NotInheritable</strong>, que indicará que no puede ser heredada.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">NotInheritable Class Trabajador
    Inherits Persona

End Class</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se pueden mantener referencias a objetos mas concretos, con variables mas genericas, esto es</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">' Declaración de una variable de tipo Persona, que es clase padre de Trabajador
Dim p As Persona

' Asignación a la variable de tipo Persona de un objeto de tipo Trabajador, que será mas concreto.
p = New Trabajador()</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_abstracción">10.2.1. Abstracción</h4>
<div class="paragraph">
<p>Permite declarar un tipo parcialmente, esto es, sin declarar totalmente todos sus miembros.</p>
</div>
<div class="paragraph">
<p>En VB:NET se emplea la palabra reserada <strong>MustInherit</strong>.</p>
</div>
<div class="paragraph">
<p>Las clases <strong>Abstractas</strong> por no estar completamente definidas no son instanciables, su suo se limia unicamente a ser clases Padre.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">MustInherit Class Persona

End Class</code></pre>
</div>
</div>
<div class="paragraph">
<p>Las Clases Abstracatas habitualemente tiene métodos abstractos, esto se consigue con la palabra <strong>MustOverride</strong>, cuando un método es marcado como <strong>MustOverride</strong> no llevará cuerpo.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">MustInherit Class Persona

        MustOverride Sub metodo()

End Class</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_interfaces">10.2.2. Interfaces</h4>
<div class="paragraph">
<p>Permiten establecer un contrato que ha de cumplir una clase, en forma de las acciones que como minimo va a tener que proporcionar la clase que cumpla el contrato.</p>
</div>
<div class="paragraph">
<p>Son utiles para establecer arquitecturas, dado que permiten definir relaciones entre clases que no tienen porque existir todavia.</p>
</div>
<div class="paragraph">
<p>En VB.NET, una interface se declara con la palabra reservada <strong>Interface</strong></p>
</div>
<div class="paragraph">
<p>Por convenio los nombres de las interfaces deberan empezar por <strong>I</strong>.</p>
</div>
<div class="paragraph">
<p>Todos los métodos declarados en una <strong>Interface</strong>, son <strong>Public</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Public Interface IAccount
   Sub PostInterest()
End Interface</code></pre>
</div>
</div>
<div class="paragraph">
<p>Para indicar que una clase se compromete en cumplir una interface, se emplea la palabra reservada <strong>Implements</strong>, tanto a nivel de la clase, como del método implementado</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Public Class BusinessAccount
                                Implements IAccount

        Sub PostInterest() Implements IAccount.PostInterest

        End Sub

End Class</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se pueden definir variables de un tipo <strong>Interface</strong>, aunque no se pueden instanciar Interfaces, a este respecto funcionan como clases abstractas.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_polimorfismo">10.3. Polimorfismo</h3>
<div class="paragraph">
<p>Existen dos tipos de polimorfismo</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Estático &#8594; Se resuelve en tiempo de compilación. Es el mecanismo de la sobrecarga de métodos.</p>
</li>
<li>
<p>Dinámico &#8594; Se resuelve el tiempo de ejecución. Es el mecanismo de la sobrescritura de métodos.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_sobrecarga">10.3.1. Sobrecarga</h4>
<div class="paragraph">
<p>Permite definir métodos que se llamen de la misma forma y dependiendo de los tipos de los parametros, se ejecuta un método u otro.</p>
</div>
<div class="paragraph">
<p>Cuando se produzca la sobrecarga, se deberán marcar los métodos con <strong>Overloads</strong> o con <strong>Overrides</strong>, si es que además de sobrecarga, se está produciendo sobrescritura.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Class Trabajador

    Overloads Sub metodo()
        Console.WriteLine(&quot;En Trabajador&quot;)
    End Sub

    Overloads Sub metodo(parametro As String)

    End Sub

End Class</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sobrescritura_y_sombreado">10.3.2. Sobrescritura y Sombreado</h4>
<div class="paragraph">
<p>Permite reemplazar métodos de la clase padre.</p>
</div>
<div class="paragraph">
<p>Para ello VB.NET propociona diferentes palabras reservadas</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Overridable &#8594; Marca un método de una clase padre, como invalidable.</p>
</li>
<li>
<p>Overrrides &#8594; Reemplaza un método marcado como <strong>Overridable</strong> en la clase base</p>
</li>
<li>
<p>NotOverridable &#8594; Marca un método como no invalidable, es obligatorio que dicho método sobrescriba otro</p>
</li>
<li>
<p>MustOverride &#8594; Indica que el método es abstracto, no tiene cuerpo y por tanto debe ser implementado por la clase hija, cualquier clase con métodos <strong>MustOverride</strong>, deberá ser marcada como <strong>MustInherit</strong></p>
</li>
<li>
<p>Shadows &#8594; Marca un método de una clase Hija, para que sombree el método con la misma firma de la clase Padre.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>El sombreado, es el comportamiento por defecto en VB.NET con respecto a la sobrescritura.</p>
</div>
<div class="paragraph">
<p>Para poder hacer sobrescritura, el método del padre ha de ser marcado como <strong>Overridable</strong>, aunque esto no garantiza que se produzca la sobrescritura, para asegurarse la sobrescritura y no el sombreado, hay que marcar el método de la clase hija con <strong>Overrides</strong>, de no hacerlo, se presupone que está marcado con Shadows.</p>
</div>
<div class="paragraph">
<p>La diferencia entre sobrescritura y sombreado, viene determinada por el codigo que se ejecuta cuando se tiene una variable del tipo Padre que hace referencia a un objeto del tipo Hijo y se invoca un método que está sobrescrito o sombreado.</p>
</div>
<div class="paragraph">
<p>Veamos un ejemplo, en el que se produce Sombreado</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Module Module1

    Sub Main()

        Dim p As Persona = New Trabajador()

        Dim t As Trabajador = p

        Console.WriteLine(&quot;Sombreado&quot;)
        'Se invoca el método desde una variable de tipo Trabajador, por lo que se accede a lo definido en Trabajador
        t.metodoSombreado()
        'Se invoca el método desde una variable de tipo Persona, por lo que se accede a lo definido en Persona, aunque el
        'objeto sea de tipo Trabajador
        p.metodoSombreado()

        Console.ReadLine()

    End Sub

End Module

Class Persona

        ' La marca Overridable en este caso es opcional
    Overridable Sub metodoSombreado()
        Console.WriteLine(&quot;En persona&quot;)
    End Sub

End Class

Class Trabajador

    Shadows Sub metodoSombreado()
        Console.WriteLine(&quot;En Trabajador&quot;)
    End Sub

End Class</code></pre>
</div>
</div>
<div class="paragraph">
<p>Veamos un ejemplo, en el que se produce Sobrescritura</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Module Module1

    Sub Main()

        Dim p As Persona = New Trabajador()

        Dim t As Trabajador = p

        Console.WriteLine(&quot;Sobrescritura&quot;)
        'Se invoca el método desde una variable de tipo Trabajador, por lo que se accede a lo definido en Trabajador
        t.metodoSobrescrito()
        'Se invoca el método desde una variable de tipo Persona, pero se accede a lo definido en Trabajador, ya que el
        'objeto es de tipo Trabajador
        p.metodoSobrescrito()

        Console.ReadLine()

    End Sub

End Module

Class Persona

        ' La marca Overridable en este caso es obligatoria
    Overridable Sub metodoSobrescrito()
        Console.WriteLine(&quot;En persona&quot;)
    End Sub

End Class

Class Trabajador

    Overrides Sub metodoSobrescrito()
        Console.WriteLine(&quot;En Trabajador&quot;)
    End Sub

End Class</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_clases">11. Clases</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Una clase describe las variables, propiedades, procedimientos y eventos de un tipo de objetos.</p>
</div>
<div class="paragraph">
<p>Los objetos son instancias de clases, pudiendo crearse tantos objetos como sean necesarios de una determinada clase.</p>
</div>
<div class="paragraph">
<p>Las clases son tipos referencia.</p>
</div>
<div class="paragraph">
<p>Los miembros de clases de tipo variables y constantes son por defecto <strong>Private</strong>, el resto son <strong>Public</strong>.</p>
</div>
<div class="paragraph">
<p>Una variable de clase puede hacer referencia a varias instancias de clase en distintos momentos.</p>
</div>
<div class="paragraph">
<p>Si se asigna Nothing a una variable de clase, no se tiene acceso a los métodos ya que no hay instancia asociada.</p>
</div>
<div class="paragraph">
<p>Dos variables de clase se pueden comparar mediante el método Equals. Equals indica si las dos variables apuntan a la misma instancia.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Public Class employee

End Class</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_miembros">11.1. Miembros</h3>
<div class="paragraph">
<p>Los miembros de una <strong>Clase</strong> pueden ser</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Campos</p>
</li>
<li>
<p>Propiedades</p>
</li>
<li>
<p>Metodos</p>
</li>
<li>
<p>Eventos</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_campos_y_propiedades">11.2. Campos y Propiedades</h3>
<div class="paragraph">
<p>Representan información almacenada en un objeto.</p>
</div>
<div class="paragraph">
<p>Un <strong>Campo</strong>, representa información asociada al objeto que se puede establecer directamente, se declaran como una variable a nivel de <strong>Clase</strong>, tambien se las llama "Variables miembro".</p>
</div>
<div class="paragraph">
<p>Normalmente los <strong>Campos</strong> serán <strong>Private</strong> o <strong>Protected</strong>, dado que siguiendo el paradigma de orientación a objetos no es interesante permitir el acceso directo a la información del objeto.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Public Class employee
        ' Decalracion de Campo
    Private salaryValue As Double
End Class</code></pre>
</div>
</div>
<div class="paragraph">
<p>Una <strong>Propiedad</strong>, representa la forma de encapsular el acceso a información asociada al objeto, que para ser leida o establecida, se empleará una propiedad cuando se precise de algun tipo de procesamiento sobre el campo previo a la lectura o establecimiento, ya sea, por ejemplo, una validación para su establecimiento o un calculo para su lectura.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Public Class employee
        ' Declaración de propiedad sobre un campo privado con get y set
        Public Property salary() As Double
        Get
            Return salaryValue
        End Get
        Set(ByVal value As Double)
            salaryValue = value
        End Set
    End Property
End Class</code></pre>
</div>
</div>
<div class="paragraph">
<p>Si se define una <strong>Propiedad</strong> como <strong>ReadOnly</strong>, no será obligatorio definir el <strong>Set</strong> y si se define como <strong>WriteOnly</strong>, no será necesario definir el <strong>Get</strong>, de no emplearse ninguno de estos modificadores, será obligatorio declarar tanto <strong>Get</strong> como <strong>Set</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">ReadOnly Property quoteForTheDay() As String
    Get
        Return quoteValue
    End Get
End Property</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_métodos">11.3. Métodos</h3>
<div class="paragraph">
<p>Un método es una acción que puede realizar un objeto.</p>
</div>
<div class="paragraph">
<p>Los Métodos pueden ser de varios tipos</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Subprocedimientos (Sub)</p>
</li>
<li>
<p>Funciones (Function)</p>
</li>
<li>
<p>Procedimientos de control de eventos</p>
</li>
<li>
<p>Get y Set asociados a una propiedad</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Se puede aplicar <strong>sobrecarga</strong> a los métodos.</p>
</div>
<div class="sect3">
<h4 id="_subprocedimientos">11.3.1. Subprocedimientos</h4>
<div class="paragraph">
<p>Procedimientos que no retornan valor.</p>
</div>
<div class="paragraph">
<p>La forma de declararlos será</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">&lt;Modificador de visibilidad&gt; Sub &lt;Nombre del procedimiento&gt;(&lt;variable&gt; As &lt;Tipologia de la variable&gt;, ...)

End Sub</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se puede terminar una subprocedimiento antes de terminar todas las sentencias con las sentencias de <strong>Exit Sub</strong> o <strong>Return</strong>.</p>
</div>
<div class="paragraph">
<p>Se puede definir un subprocedimiento en <strong>Módulos</strong>, <strong>Clases</strong> y <strong>Estructuras</strong>.</p>
</div>
<div class="paragraph">
<p>Son <strong>Public</strong> de forma predeterminada.</p>
</div>
<div class="paragraph">
<p>La invocación se hará a traves de la instancia de un objeto, on el operador punto (<strong>.</strong>).</p>
</div>
</div>
<div class="sect3">
<h4 id="_control_de_eventos">11.3.2. Control de Eventos</h4>
<div class="paragraph">
<p>Si el procedimiento representa el manejador de un evento de un componente, se puede añadir <strong>Handles</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">&lt;Modificador de visibilidad&gt; Sub &lt;Nombre del procedimiento&gt;(&lt;variable&gt; As &lt;Tipologia de la variable&gt;, ...) Handles &lt;El evento de que componente procesa&gt;

End Sub</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_funciones">11.3.3. Funciones</h4>
<div class="paragraph">
<p>Procedimientos que retornan valor.</p>
</div>
<div class="paragraph">
<p>La forma de declararlos será</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">&lt;Modificador de visibilidad&gt; Function &lt;Nombre del procedimiento&gt;(&lt;variable&gt; As &lt;Tipologia de la variable&gt;, ...) As &lt;Tipo retornado&gt;
        Return &lt;Objeto retornado&gt;
End Function</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se puede terminar una subprocedimiento antes de terminar todas las sentencias con las sentencias de <strong>Exit Function</strong> o <strong>Return</strong>.</p>
</div>
<div class="paragraph">
<p>Son <strong>Public</strong> de forma predeterminada.</p>
</div>
<div class="paragraph">
<p>La invocación se hará a traves de la instancia de un objeto, on el operador punto (<strong>.</strong>).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_paso_de_parametros_a_métodos">11.4. Paso de parametros a métodos</h3>
<div class="sect3">
<h4 id="_por_referencia">11.4.1. Por referencia</h4>
<div class="paragraph">
<p>Se emplea la palabra reservada <strong>ByRef</strong>, su uso indica que un parametro se pasa por referencia, es decir, se pasa la direccion de memoria donde esta el objeto, lo que implica que si la función que recibe el parametro lo cambia, cambia alguna caracteristica del objeto al que apunta el parametro, este objeto cambia de cara al exterior de la función.</p>
</div>
</div>
<div class="sect3">
<h4 id="_por_valor">11.4.2. Por valor</h4>
<div class="paragraph">
<p>Cuando se utiliza este mecanismo para pasar argumentos, Visual Basic copia el valor del objeto pasado por parametro en una variable local de la función, por lo que la fución, no tiene acceso al objeto original, solo a la copia local, por lo tanto cualquier modificación se hace sobre la copia y no afecta al objeto original.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">' Esta funcion recibe dos parametros, uno por referencia debt, que al recibirse representa el valor original y al acabar la función representa el valor original mas el tanto por ciento aplicado
' En cambio rate, se pasa por valor, ya que no se quiere que la función pueda modificar el tanto por ciento aplicado
Sub Calculate(ByVal rate As Double, ByRef debt As Double)
        debt = debt + (debt * rate / 100)
End Sub</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_constructores">11.5. Constructores</h3>
<div class="paragraph">
<p>Son los que permiten crear instancias (objetos) de las <strong>Clases</strong> definidas.</p>
</div>
<div class="paragraph">
<p>Los constructores en VB.NET son procediminetos <strong>Sub</strong> llamados <strong>New</strong>.</p>
</div>
<div class="paragraph">
<p>La primera linea del constructor debera ser siempre la invocación al constructor del padre, esto se consigue con la palabra reservada <strong>MyBase</strong>. De tener la clase padre un constructor sin parametros, esta linea es opcional, dado que el compilador la añade automaticamente.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">'Constructor sin parametros
Public Sub New()
        ' MyBase.New() siempre debe estar en el constructor
    MyBase.New()
End Sub</code></pre>
</div>
</div>
<div class="paragraph">
<p>Al igual que con los métodos, se puede aplicar <strong>sobrecarga</strong> a los constructores, pudiendo existir tantos constructores como queramos, siempre que varien en orden o número los parametros que reciben.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">'Constructor con parametros
Public Sub New(propiedad As String)
        ' MyBase.New() siempre debe estar en el constructor
    MyBase.New()

    Me.propiedad = propiedad

End Sub</code></pre>
</div>
</div>
<div class="paragraph">
<p>Para la construcción de un objeto, se emplea la palabra reservada <strong>New</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim variable As New String(&quot;texto de la variable&quot;)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_casting">11.6. Casting</h3>
<div class="paragraph">
<p>Dado que se pueden tener referencias a objetos con variables de distinto tipo, en ocasiones es necesario realizar conversiones de tipo, para ello VB.NEt proporciona el operador <strong>CType</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim entero As Integer = 1

Dim cadena As String = CType(i, String)</code></pre>
</div>
</div>
<div class="paragraph">
<p>No todos los tipos son convertibles en todos los demas tipos, dado que no tiene porque estar definido el operador <strong>CType</strong> que relaciones el tipo origen y el destino.</p>
</div>
<div class="paragraph">
<p>Los tipos basicos se pueden convertir entre si y cuando hay herencia tambien.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_estructuras">12. Estructuras</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Las estructuras son tipo valor, una variable de un tipo de estructura contiene los datos de la estructura, en lugar de contener una referencia a los datos, como sucede con los tipos de clase.</p>
</div>
<div class="paragraph">
<p>Además de campos, las estructuras pueden exponer propiedades, métodos y eventos.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Private Structure employee
    Public givenName As String
    Public familyName As String
    Public phoneExtension As Long
    Private salary As Decimal
    Public Sub giveRaise(raise As Double)
        salary *= raise
    End Sub
    Public Event salaryReviewTime()
End Structure</code></pre>
</div>
</div>
<div class="paragraph">
<p>No se puede heredar de una estructura, aunque una estructura si puede implmentar una <strong>Interface</strong>.</p>
</div>
<div class="paragraph">
<p>Las estructuras heredan de forma implicita de System.ValueType.</p>
</div>
<div class="paragraph">
<p>Se recomienda emplear estructuras cuando el tipo de dato definido sea pequeño.</p>
</div>
<div class="paragraph">
<p>Por defecto todos los miembros de una estructura son <strong>Public</strong>.</p>
</div>
<div class="paragraph">
<p>Una estructura debe tener al menos una variable no compartida.</p>
</div>
<div class="paragraph">
<p>Los elementos de estructura no se pueden declarar como Protected.</p>
</div>
<div class="paragraph">
<p>Las estructuras no son recolectadas por el GC.</p>
</div>
<div class="paragraph">
<p>Las estructuras no requieren de un constructor, ya que podeen de forma implicita el constructor por defecto, que no puede ser redefinido.</p>
</div>
<div class="paragraph">
<p>Cada variable de estructura está enlazada de forma permanente a una instancia de estructura individual.</p>
</div>
<div class="paragraph">
<p>Si se asigna Nothing a una variable de estructura, no se elimina el enlace con la instancia, aunque se inicialicen los miembros, por lo que se tiene acceso a los métodos.</p>
</div>
<div class="paragraph">
<p>La comprobación de igualdad de dos instancias de estructura debe realizarse mediante una prueba elemento a elemento.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_modulos">13. Modulos</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_namespace">14. Namespace</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Permiten organizar los elementos definidos en un ensamblado, es una forma de agrupar <strong>Clases</strong>, <strong>Interfaces</strong> y demas elementos definibles en un ensamblado.</p>
</div>
<div class="paragraph">
<p>Se emplea la palabra reservada <strong>Namespace</strong>, creando un bloque de código que contendra los elementos ordenados dentro de ese <strong>Namespace</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Namespace Entidades

        Public Class Persona

        End Class

End Namespace</code></pre>
</div>
</div>
<div class="paragraph">
<p>Su principal misión, es que no haya conflictos con los nombres, dado que el nombre de los elementos, sera el de su Namespace mas el del propio elemento.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">' Para declarar una variable del tipo anteriormente descrito, es preciso hacer referencia al nombre completo
Dim p As Entidades.Persona</code></pre>
</div>
</div>
<div class="paragraph">
<p>Si se hace referencia a un tipo dentro del mismo <strong>Namespace</strong> donde es declarado, no es necesario indicarlo.</p>
</div>
<div class="paragraph">
<p>Los <strong>Namespace</strong> se pueden anidar, creando estructuras mas comlejas de organizacion</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Namespace Aplicacion

        Namespace Entidades

                Public Class Persona

                End Class

        End Namespace

End Namespace</code></pre>
</div>
</div>
<div class="paragraph">
<p>Este anidamiento puede provocar que los nombres completos sean muy largos, y por tanto dificiles de escribir, para evitar tener que escribir continuamente los nombres se pueden crear alias de esto con la palabra reservada <strong>Imports</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Imports Aplicacion.Entidades

Sub Main()

    Dim p As Persona

End Sub</code></pre>
</div>
</div>
<div class="paragraph">
<p>En Visual Studio, en las propiedades del proyecto, se define un <strong>Namespace Raiz</strong>, que es el que tendran de forma implicita todos los elementos definidos dentro del proyecto (ensamblado)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_palabras_reservadas">15. Palabras reservadas</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_me">15.1. Me</h3>
<div class="paragraph">
<p>Palabra reservada que permite referenciar a la instancia actual de la clase
donde se este ejecutando.</p>
</div>
</div>
<div class="sect2">
<h3 id="_mybase">15.2. MyBase</h3>
<div class="paragraph">
<p>Hace referencia a la parte de la instancia que corresponde a la clase padre, se emplea en los constructores y en los métodos sobreescritos.</p>
</div>
</div>
<div class="sect2">
<h3 id="_new">15.3. New</h3>
<div class="paragraph">
<p>Permite instanciar objetos de clases. Se pueden crear objetos en el momento de la declaración de una variable, o en cualquier otro momento.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">' Declaración de variable, creación de objeto y asignación del objeto a la variable
Dim variable As New String(&quot;texto de la variable&quot;)

' Declaración de variable
Dim otra As String

' Creación de objeto y asignación a la variable
otra = New String(&quot;valor de otra variable&quot;)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_partial">15.4. Partial</h3>
<div class="paragraph">
<p>Permite dividir la definición de un tipo en varias declaraciones.</p>
</div>
<div class="paragraph">
<p>Los tipos que se pueden dividir son: <strong>Class</strong>, <strong>Structure</strong>, <strong>Interface</strong> y <strong>Module</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Partial Public Class sampleClass
    Public Sub sub1()
    End Sub
End Class
Partial Public Class sampleClass
    Public Sub sub2()
    End Sub
End Class</code></pre>
</div>
</div>
<div class="paragraph">
<p>Por ejemplo, el Diseñador de Windows Forms define clases parciales para controles como Form.</p>
</div>
</div>
<div class="sect2">
<h3 id="_readonly">15.5. ReadOnly</h3>
<div class="paragraph">
<p>Especifica que una variable o una propiedad se puede leer, pero no se puede modificar.</p>
</div>
<div class="paragraph">
<p>No se puede especificar <strong>ReadOnly</strong> junto con <strong>Static</strong> en la misma declaración.</p>
</div>
<div class="paragraph">
<p>Sólo puede asignar un valor a una variable <strong>ReadOnly</strong> en su declaración o en el constructor de una clase o estructura en la que está definida.</p>
</div>
</div>
<div class="sect2">
<h3 id="_writeonly">15.6. WriteOnly</h3>
<div class="paragraph">
<p>Especifica que se puede escribir pero no leer una propiedad.</p>
</div>
<div class="paragraph">
<p>Se puede declarar una propiedad como WriteOnly, pero no una variable.</p>
</div>
</div>
<div class="sect2">
<h3 id="_shared">15.7. Shared</h3>
<div class="paragraph">
<p>Indica que un atributo de clase es compartido por todas las instancias de esa clase.</p>
</div>
</div>
<div class="sect2">
<h3 id="_static">15.8. Static</h3>
<div class="paragraph">
<p>Especifica si una variable local a un método debe seguir existiendo y conservar su último valor tras la finalización del método en el que se han declarado.</p>
</div>
<div class="paragraph">
<p>Normalmente, una variable local de un método deja de existir en cuanto finaliza el método, en cambio una variable estática sigue existiendo y conserva su valor más reciente, por lo que la próxima vez que se invoque el método, la variable no se reinicializa, conservando el último valor asignado.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">' totalSales solo se inicializa a 0 una v ez, la primera vez que se invoca el método, el resto de ocasiones en las que se invoca el método, el valor de totalSales, será el último que tuviese.
Function updateSales(ByVal thisSale As Decimal) As Decimal
    Static totalSales As Decimal = 0
    totalSales += thisSale
    Return totalSales
End Function</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_nothing">15.9. Nothing</h3>
<div class="paragraph">
<p>Palabra reservada que representa NULL.</p>
</div>
<div class="paragraph">
<p>Los tipos referencia aceptan el valor Nothing.</p>
</div>
<div class="paragraph">
<p>Para que un tipo valor acepte Nothing, en la declaración, hay que indicarlo con el caracter <strong>?</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="_optional">15.10. Optional</h3>
<div class="paragraph">
<p>Permite indicar si un parametro es obligatorio o es opcional.</p>
</div>
<div class="paragraph">
<p>De definirse el parametro como opcion, será obligatorio indicar un valor por defecto para dicho parametro.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Sub notify(Optional ByVal office As String = &quot;QJZ&quot;)

End Sub</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_enumeraciones_y_constantes">16. Enumeraciones y constantes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Permiten definir grupos de constantes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Public Enum Mammals
    Buffalo
    Gazelle
    Mongoose
    Rhinoceros
    Whale
End Enum</code></pre>
</div>
</div>
<div class="paragraph">
<p>Son de tipo Integer por defecto, aunque pueden ser de cualquiera e los tipos enteros Byte, Short, Long o Integer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Public Enum Mammals As Integer
    Buffalo
    Gazelle
    Mongoose
    Rhinoceros
    Whale
End Enum</code></pre>
</div>
</div>
<div class="paragraph">
<p>A cada uno de los elementos de la enumeración se le puede asignar un valor entero.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Public Enum Mammals As Integer
    Buffalo = 1
    Gazelle
    Mongoose = -3
    Rhinoceros
    Whale
End Enum</code></pre>
</div>
</div>
<div class="paragraph">
<p>Todos los enum heredan de System.Enum, que proporciona una serie de métodos como <strong>GetNames</strong> que permite obtener la representacion en <strong>String</strong> del valor enumerado.</p>
</div>
<div class="paragraph">
<p>Para iterar sobre un enumerado, se emplea la clase System.Enum</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim items As Array
items = System.Enum.GetValues(GetType(Mammals))
Dim item As String
For Each item In items
    Console.WriteLine(item)
Next</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se pueden definir constantes individuales con la palabra reservada <strong>Const</strong>, tanto a nivel de campo de clase, como de variable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Public Const DaysInYear = 365</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_excepciones">17. Excepciones</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Las excepciones son eventos que se producen en el código, que indican que ha
sucedido algo, que no entra dentro de la ejecución <strong>normal</strong> del codigo.</p>
</div>
<div class="paragraph">
<p>El API de VB.NET, lanza excepciones en alguna de sus fundionalidades, por lo que
habrá que tenerlo en cuenta.</p>
</div>
<div class="paragraph">
<p>El propio programador, puede establecer cuando quiere que se genere una
excepcion, para ello ha de crear un objeto de tipo Exception y lanzarlo</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Throw New NullReferenceException(&quot;Something happened.&quot;)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se pueden hacer dos cosas con las excepiones</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Propagarlas</p>
</li>
<li>
<p>Capturarlas</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>La propagación en VB.NET es automatica, no hay que indicar nada.</p>
</div>
<div class="paragraph">
<p>Para capturarlas, se emplea la sentencia de control <strong>Try&#8230;&#8203;Catch&#8230;&#8203;Finally</strong>, donde
se prueba a ejecutar, el contenido de <strong>Try</strong>, si durante la ejecución se produce
una excepción, se ejecutará el bloque de <strong>Catch</strong> y sino no, y pase lo que pase,
se ejecutará siempre <strong>Finally</strong> al finalizar de ejectar el bloque.</p>
</div>
<div class="paragraph">
<p>Cuando se produce una excepcion en una sentencia el resto de sentencias del
bloque, no se ejecuta.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Public Sub TryExample()
    ' variables.
    Dim x As Integer = 5
    Dim y As Integer = 0

    ' Estructura de captura de excepciones.
    Try
        ' Esta sentencia genera una excepcion de division por 0.
        x = x \ y

        ' Estas sentencia no se ejecutan porque ocurre una excepcion.
        MessageBox.Show(&quot;Fin del bloque Try&quot;)
    Catch ex As Exception
        ' Se muestra el mensaje asociado a la excepcion.
        MessageBox.Show(ex.Message)

        ' Se muesra la traza de la excepción, que puede dar muestras de donde
                                ' viene dicha excepcion.
        MessageBox.Show(&quot;Stack Trace: &quot; &amp; vbCrLf &amp; ex.StackTrace)
    Finally
        ' Esta sentencia se ejecuta hay o no excepcion.
        MessageBox.Show(&quot;Dentro del bloque Finally&quot;)
    End Try
End Sub</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pueden existir multiples bloques de <strong>Catch</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Public Sub RunSample()
    Try
        CreateException()
    Catch ex As System.IO.IOException
        ' Este bloque se ejecuta si se produce una IOException.
    Catch ex As NullReferenceException
        ' Este bloque se ejecuta si se produce una NullReferenceException.
    Catch ex As Exception
        ' Este bloque se ejecuta si se produce cualquier otra Excepcion, ya que
                                ' todas heredan de Exception.
    End Try
End Sub</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se pueden establecer condiciones para ejecutar el bloque <strong>Catch</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Private Sub WhenExample()
    Dim i As Integer = 5

    Try
        Throw New ArgumentException()
    Catch e As OverflowException When i = 5
        Console.WriteLine(&quot;First handler&quot;)
    Catch e As ArgumentException When i = 4
        Console.WriteLine(&quot;Second handler&quot;)
    Catch When i = 5
        Console.WriteLine(&quot;Third handler&quot;)
    End Try
End Sub</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_colecciones">18. Colecciones</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Son una forma que proporciona el API de VB.NET de tener agrupados varios objetos de una misma tipologia.</p>
</div>
<div class="paragraph">
<p>Son muy parecidas a los Array, salvo por que si bien los <strong>Array</strong> tienen un tamaño fijo durante toda la vida del objeto, las <strong>Colecciones</strong> pueden cambiar de forma dinamica su tamaño.</p>
</div>
<div class="paragraph">
<p>Se basan en las clases dentro del <strong>Namespace</strong> llamado <strong>System.Collections</strong></p>
</div>
<div class="paragraph">
<p>El API se basa en las siguientes <strong>Interfaces</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>System.Collections.ICollection &#8594; Interface general para las colecciones.</p>
</li>
<li>
<p>System.Collections.IList &#8594; Interface para modelar colecciones de elementos ordenados por indice</p>
</li>
<li>
<p>System.Collections.IDictionary &#8594; Interface para modelar colecciones de pares, clave y valor</p>
</li>
<li>
<p>System.Collections.Generic.ICollection</p>
</li>
<li>
<p>System.Collections.Generic.IList</p>
</li>
<li>
<p>System.Collections.Generic.IDictionary</p>
</li>
<li>
<p>System.Collections.Generic.ISet &#8594; Interface par modelar colecciones de elementos no repetibles</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Algunas de las clases que nos podemos encontrar en ese paquete son</p>
</div>
<div class="ulist">
<ul>
<li>
<p>System.Collections.ArrayList &#8594; Implmentación de <strong>IList</strong> y de <strong>ICollection</strong>, basado en un <strong>Array</strong> interno que se redimensiona segun las necesidades</p>
</li>
<li>
<p>System.Collections.Hashtable &#8594; Implementación de <strong>IDictionary</strong> y <strong>ICollection</strong>, que emplea el Hash de los objetos para organizarlos dentro de la coleccion y que sea mas eficiente la búsqueda.</p>
</li>
<li>
<p>System.Collections.Queue &#8594; Implementacon de <strong>Collection</strong> que modela una <strong>Cola</strong></p>
</li>
<li>
<p>System.Collections.Stack &#8594; Implementacion de <strong>ICollection</strong> que modela una <strong>Pila</strong></p>
</li>
<li>
<p>System.Collections.SortedList &#8594; Implementacion de <strong>IDictionary</strong> y <strong>ICollection</strong> ordenados por clave.</p>
</li>
<li>
<p>System.Collections.Generic.Dictionary</p>
</li>
<li>
<p>System.Collections.Generic.HashSet</p>
</li>
<li>
<p>System.Collections.Generic.LinkedList</p>
</li>
<li>
<p>System.Collections.Generic.List</p>
</li>
<li>
<p>System.Collections.Generic.Queue</p>
</li>
<li>
<p>System.Collections.Generic.SortedList</p>
</li>
<li>
<p>System.Collections.Generic.SortedDictionary</p>
</li>
<li>
<p>System.Collections.Generic.SortedSet</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Las colecciones <strong>Generic</strong>, siguen la misma pauta que las normales, pero limitan el tipo de datos que contienen en el momento de la declaración dle objeto.</p>
</div>
<div class="paragraph">
<p>Para definir las collecciones</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">'Collection
Dim coleccion As Collection = New Collection

'Normales
Dim arrayList As ArrayList

Dim hashTable As Hashtable

Dim queue As Queue

Dim stack As Stack

Dim sortedList As SortedList

'Generic
Dim dictionaryGeneric As Dictionary(Of String, String)

Dim hashSetGeneric As HashSet(Of String)

Dim linkedListGeneric As LinkedList(Of String)

Dim listGeneric As List(Of String) = New List(Of String)

Dim queueGeneric As Queue(Of String)

Dim sortedListGeneric As SortedList(Of String, String)

Dim sortedDictionary As SortedDictionary(Of String, String)

Dim sortedSet As SortedSet(Of String)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Para añadir elementos a un collecion</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">arrayList.Add(&quot;dato&quot;)

hashTable.Add(&quot;key&quot;, &quot;value&quot;)

queue.Enqueue(&quot;dato&quot;)

stack.Push(&quot;dato&quot;)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Para eliminar elementos</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">arrayList.Remove(&quot;dato&quot;)
' Borra el eleemnto por su posición
arrayList.RemoveAt(0)

hashTable.Remove(&quot;key&quot;)
'Borra y retorna el objeto al principio de la cola
queue.Dequeue()
'Retorna el objeto al principio de la cola sin borrarlo
queue.Peek()
'Borra y retorna el objeto en la tapa de la pila
stack.Pop()
'Retorna el objeto en la tapa de la pila sin borrarlo
stack.Peek()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Para recorrer las colecciones, se pueden emplear estructuras de For Each</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic"></code></pre>
</div>
</div>
<div class="paragraph">
<p>Especial mención a la clase <strong>Microsoft.VisualBasic.Collection</strong>, que es una clase que permite definir varios tipos de colecciones.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ado_net">19. ADO.NET</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Existen varias posibilidades de base de datos</p>
</div>
<div class="ulist">
<ul>
<li>
<p>LocalDB, es representado por un fichero local con extension mdf</p>
</li>
<li>
<p>SQL Server</p>
</li>
<li>
<p>ODBC</p>
</li>
<li>
<p>Oracle</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_componentes_ado_net">19.1. Componentes ADO.NET</h3>
<div class="ulist">
<ul>
<li>
<p>Proveedores de datos</p>
<div class="ulist">
<ul>
<li>
<p>Connection &#8594; Proporciona conectividad a un origen de datos.</p>
</li>
<li>
<p>Command &#8594; Representa sentencias de SQL sobre la BD.</p>
</li>
<li>
<p>DataReader &#8594; Proporciona un flujo de datos desde la BD a la aplicación de alto rendimiento.</p>
</li>
<li>
<p>DataAdapter &#8594; Permite cargar nuevos datos en el <strong>DataSet</strong> a traves de <strong>Command</strong>. Proporciona un puente entre el origen de datos y el DataSet.</p>
</li>
<li>
<p>DataSet &#8594; Conjunto de objetos <strong>DataTable</strong>, representa una copia en memoria de los datos de la base de datos</p>
<div class="ulist">
<ul>
<li>
<p>DataTable &#8594; Representa una Tabla de una base de datos</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Para poder emplear en el codigo de una clase estas clases, se ha de añadir</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Imports System.Data.SqlClient
Imports System.Data</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_connection">19.2. Connection</h3>
<div class="paragraph">
<p>Representan la conexion a la base de datos, dado que la base de datos no admite infinitas conexiones, se ha de cuidar no dejarlas abiertas y cerrarlas cuando no se necesiten, para ello y aprovechando que implementan <strong>IDisposable</strong>, se puede emplear la estructura <strong>Using&#8230;&#8203;End Using</strong></p>
</div>
<div class="paragraph">
<p>No se puede reabrir un objeto <strong>Connection</strong> una vez cerrado, se ha de crear un nuevo objeto.</p>
</div>
</div>
<div class="sect2">
<h3 id="_command">19.3. Command</h3>
<div class="paragraph">
<p>Representan una consulta sobre la base de datos.</p>
</div>
<div class="paragraph">
<p>Pueden ser de tres tipos</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CommandType.Text &#8594; Consulta SQL</p>
</li>
<li>
<p>CommandType.StoredProcedure &#8594; Nombre de un procedimiento almacenado</p>
</li>
<li>
<p>CommandType.TableDirect &#8594; Nombre de una tabla</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Se pueden ejecutar de tres formas</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ExecuteNonQuery &#8594; Se emplea para ejecutar sentencias de tipo INSERT, UPDATE y DELETE, que cambian el estado de la BD.</p>
</li>
<li>
<p>ExecuteReader &#8594; Retorna un objeto <strong>Reader</strong>, con los registros retornados por la consulta, se emplea para sentencias de tipo SELECT.</p>
</li>
<li>
<p>ExecuteScalar &#8594; Retorna el primer valor del conjunto de registros.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Los Command son parametrizables, se pueden definir en el string que representa la consulta parametros indicados con el prefijo @, y posteriormente ser sustituidos.</p>
</div>
<div class="paragraph">
<p>Ejemplo de Command que realiza una consulta</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim con = New SqlConnection(stCon)

Dim queryVictor As String = &quot;Select * from personas where nombre = @nombre&quot;

Using con

    con.Open()

    Dim command As SqlCommand = New SqlCommand(queryVictor, con)

    Dim param As SqlParameter = New SqlParameter(&quot;@nombre&quot;, &quot;Victor&quot;)

    command.Parameters.Add(param)

    Dim reader = command.ExecuteReader()

    Dim tablaPersonasConNombreVictor = New DataTable(&quot;PersonasConNombreVictor&quot;)

    tablaPersonasConNombreVictor.Load(reader)

    DataGridView3.DataSource = tablaPersonasConNombreVictor

End Using</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ejemplo de Command que realiza un borrado</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim con As SqlConnection = New SqlConnection(stCon)

Dim queryDeletePersona As String = &quot;Delete from personas where nombre = @nombre&quot;

Using con

    con.Open()

    Dim command As SqlCommand = New SqlCommand(queryDeletePersona, con)

    Dim paramNombre As SqlParameter = New SqlParameter(&quot;@nombre&quot;, &quot;Jacinto&quot;)

    command.Parameters.Add(paramNombre)

    command.ExecuteNonQuery()

End Using</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ejemplo de Command que realiza un alta</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim con = New SqlConnection(stCon)

Dim queryInsertPersona As String = &quot;Insert into personas (id, nombre)  values (@id, @nombre)&quot;

Using con

    con.Open()

    Dim command As SqlCommand = New SqlCommand(queryInsertPersona, con)

    Dim paramNombre As SqlParameter = New SqlParameter(&quot;@nombre&quot;, &quot;Jacinto&quot;)
    Dim paramId As SqlParameter = New SqlParameter(&quot;@id&quot;, &quot;9&quot;)

    command.Parameters.Add(paramNombre)
    command.Parameters.Add(paramId)

    command.ExecuteNonQuery()

End Using</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_datareader">19.4. DataReader</h3>
<div class="paragraph">
<p>Representa un conjunto de registros leidos de la base de datos, es un objeto que solo permite leer de la base de datos.</p>
</div>
<div class="paragraph">
<p>Se puede rellenar un <strong>DataTable</strong> directamente con los registros retornados.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim con = New SqlConnection(stCon)

Dim queryPersonas As String = &quot;Select * from personas&quot;

Using con

    con.Open()

    Dim command As SqlCommand = New SqlCommand(queryPersonas, con)

    Dim reader = command.ExecuteReader()

    Dim tablePersonas = New DataTable(&quot;MisPersonas&quot;)

    tablePersonas.Load(reader)

    DataGridView1.DataSource = tablePersonas

End Using</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se puede recorrer, creando objetos por cada registro y volcandolos sobre una colleción.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim con As SqlConnection = New SqlConnection(stCon)

Dim queryPersonas As String = &quot;Select * from personas&quot;

Using con

    con.Open()

    Dim command As SqlCommand = New SqlCommand(queryPersonas, con)

    Dim reader = command.ExecuteReader()

    Dim listaPersonas As List(Of Persona) = New List(Of Persona)

    If reader.HasRows Then
        Do While reader.Read()
            listaPersonas.Add(New Persona(reader.GetInt32(0), reader.GetString(1)))
        Loop
    End If

    DataGridView4.DataSource = listaPersonas

End Using</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dataadapter">19.5. DataAdapter</h3>
<div class="paragraph">
<p>Es el puente entre el <strong>DataSet</strong> y el <strong>DataSource</strong>.</p>
</div>
<div class="paragraph">
<p>Permite sincronizar en las dos direcciones</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Fill &#8594; Rellena el <strong>DataSet</strong> con los datos del <strong>DataSource</strong></p>
</li>
<li>
<p>Update &#8594; Actualiza el <strong>DataSource</strong> para que los datos de la BD coincidan con los del <strong>DataSet</strong>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_dataset">19.6. DataSet</h3>
<div class="paragraph">
<p>Contiene n objetos DataTable, que estan formados por filas <strong>DataRow</strong> y columnas de datos <strong>DataColumn</strong>.</p>
</div>
<div class="paragraph">
<p>Los DataSet permiten</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Almacenar datos en la memoria caché de la aplicación para poder manipularlos. Si solamente se necesita leer los resultados de una consulta, DataReader es mejor elección.</p>
</li>
<li>
<p>Utilizar datos de forma remota entre un nivel y otro o desde un servicio Web XML.</p>
</li>
<li>
<p>Interactuar con datos dinámicamente, por ejemplo para enlazar con un control de Windows Forms o para combinar y relacionar datos procedentes de varios orígenes.</p>
</li>
<li>
<p>Realizar procesamientos exhaustivos de datos sin necesidad de tener una conexión abierta con el origen de datos, lo que libera la conexión para que la utilicen otros clientes.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim con As SqlConnection = New SqlConnection(stCon)

Dim queryPersonas As String = &quot;Select * from personas&quot;

Dim adapterPersonas As New SqlDataAdapter(queryPersonas, con)

Using con

    con.Open()

    adapterPersonas.Fill(ds, &quot;MisPersonas&quot;)

    DataGridView1.DataSource = ds.Tables(&quot;MisPersonas&quot;)

End Using</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_connectionstring">19.7. ConnectionString</h3>
<div class="paragraph">
<p>Representan las cadenas de conexion sobre una base de datos.</p>
</div>
<div class="paragraph">
<p>Visual Studio, permite facilmente obtenerlas y almacenarlas en el fichero de configración <strong>App.config</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">&lt;configuration&gt;
    &lt;connectionStrings&gt;
        &lt;add name=&quot;PersonasConnectionString&quot;
            connectionString=&quot;Data Source=(LocalDB)\MSSQLLocalDB;AttachDbFilename=&amp;quot;D:\BaseDeDatos.mdf&amp;quot;;Integrated Security=True;Connect Timeout=30&quot;
            providerName=&quot;System.Data.SqlClient&quot; /&gt;
    &lt;/connectionStrings&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Para cargar una connectionString del fichero de configuracion, hay que añadir la referencia al proyecto de <strong>System.Configuracion</strong> y añadir el Imports a la clase correspondiente</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Imports System.Configuracion</code></pre>
</div>
</div>
<div class="paragraph">
<p>Para recuperarla, se emplea la clase <strong>ConfigurationManager</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim stCon As String = ConfigurationManager.ConnectionStrings(&quot;PersonasConnectionString&quot;).ConnectionString</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_windows_forms">20. Windows Forms</h2>
<div class="sectionbody">
<div class="paragraph">
<p>API de .NET que permite definir aplicaciones de escritorio.</p>
</div>
<div class="sect2">
<h3 id="_datagridview">20.1. DataGridView</h3>
<div class="paragraph">
<p>Componente visual, que permite representar tablas de datos.</p>
</div>
<div class="paragraph">
<p>Se ha de asociar la propiedad <strong>DataSource</strong> con un <strong>DataTable</strong>, este puede ser obtenido con</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DataReader</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim con = New SqlConnection(stCon)

Dim queryPersonas As String = &quot;Select * from personas&quot;

Using con

    con.Open()

    Dim command As SqlCommand = New SqlCommand(queryPersonas, con)

    Dim reader = command.ExecuteReader()

    Dim tablePersonas = New DataTable(&quot;MisPersonas&quot;)

    tablePersonas.Load(reader)

    DataGridView1.DataSource = tablePersonas

End Using</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>DataSet</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim con As SqlConnection = New SqlConnection(stCon)

Dim queryPersonas As String = &quot;Select * from personas&quot;

Dim adapterPersonas As New SqlDataAdapter(queryPersonas, con)

Using con

    con.Open()

    adapterPersonas.Fill(ds, &quot;MisPersonas&quot;)

    DataGridView1.DataSource = ds.Tables(&quot;MisPersonas&quot;)

End Using</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Coleccion</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">Dim con As SqlConnection = New SqlConnection(stCon)

Dim queryPersonas As String = &quot;Select * from personas&quot;

Using con

    con.Open()

    Dim command As SqlCommand = New SqlCommand(queryPersonas, con)

    Dim reader = command.ExecuteReader()

    Dim listaPersonas As List(Of Persona) = New List(Of Persona)

    If reader.HasRows Then
        Do While reader.Read()
            listaPersonas.Add(New Persona(reader.GetInt32(0), reader.GetString(1)))
        Loop
    End If

    DataGridView4.DataSource = listaPersonas

End Using</code></pre>
</div>
</div>
<div class="paragraph">
<p>De producirse cambios en el origen de datos y querer que el DataGrid se entere, se ha de refrescar</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="visualbasic">DataGridView1.Refresh()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Se puede desactivar la fila para añadir elementos, seteando la propiedad <strong>AllowUserToAddRows</strong> del <strong>DataGridView</strong>, a False.</p>
</div>
<div class="paragraph">
<p>Tambien se puede indicar que aunque este presente dicha fila, no sean sus campos editables, con la propiedad <strong>ReadOnly</strong> a True.</p>
</div>
<div class="paragraph">
<p>Incluso se podria indicar que solo unos campos son editables, accediendo a las <strong>DataColumn</strong> del <strong>DataGrid</strong> y seteando la propiedad <strong>ReadOnly</strong> a True.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2016-04-08 06:56:16 Hora de verano romance
</div>
</div>
</body>
</html>